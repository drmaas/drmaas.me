---
import ArticleCard from "@components/ArticleCard.astro";
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import config from "src/config";
import { sortDateDescending, capitalizeString } from "src/misc";

const allPosts = await getCollection('posts');

const posts = sortDateDescending(allPosts.filter((post) => post.data.draft != true && post.data.tags.includes('Featured'))).slice(0, 3);
const { metaData: { authorName }, social } = config;
---

<BaseLayout title="Home" activeLink="home">

	<section class="flex flex-col sm:flex-row justify-center max-w-[90%] w-208 mx-auto gap-12 mb-32 mt-8">
		<img class="w-64 h-64 object-cover object-left rounded-full self-center shadow-2xl ring-4 ring-primary/20" src={"/images/profile.jpg"} alt="avatar">
		<div class="flex flex-col grow justify-center">
			<h1 class="text-center mb-6 text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">
				Hi there, I'm <span class="font-extrabold">{authorName}.</span></h1>
			<p class="text-center text-lg text-base-content/80">
				<span>I write about software and life. I hope you find my posts relevant.</span>
				<span>Check out 
					<a
					class="link link-primary font-semibold"
					href="/topics/what-im-consuming/">what I'm consuming</a>.
				  </span>

				</p>
			<div class="flex justify-center gap-6 mt-6">
				{social.map(ele => <a class="w-10 h-10 flex scale-1 hover:scale-125 transition-transform duration-200 hover:opacity-80" href={ele.link}
					target="_blank" rel="noreferrer noopener">
					<span class="sr-only">{`Link to my ${capitalizeString(ele.link.replace(/.+\/\/|www.|\..+/g, ''))} account`}</span>
					<Fragment set:html={ele.svg} />
				</a> )}
			</div>
		</div>
	</section>
		
	<section>
		<h2 class="text-center mb-12 text-4xl font-bold">
			Featured Articles
		</h2>

		<div class="flex flex-col justify-center gap-8">
			{posts.map(post =>
			<ArticleCard content={post} />)}

			<a href="/articles/" class="btn btn-primary btn-lg mx-auto mt-4 shadow-lg hover:shadow-xl transition-shadow duration-200">
				<span>View All Articles</span>
				<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
				</svg>
			</a>
		</div>

	</section>
</BaseLayout>